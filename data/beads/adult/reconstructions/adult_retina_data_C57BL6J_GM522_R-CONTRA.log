[1] "Adding old segment 1"
[1] "Storing new segment 1"
[1] "Adding old segment 2"
[1] "Adding old segment 3"
[1] "Adding old segment 4"
[1] "Adding old segment 5"
[1] "Intersection found. Old points:"
   X    Y 
1370 1359 
   X    Y 
 770 1559 
   X    Y 
 770 1559 
   X    Y 
1060 1799 
[1] "Point i+1 has been changed:"
   X    Y 
1370 1359 
   X    Y 
 770 1559 
   X    Y 
 770 1559 
   X    Y 
1060 1799 
[1] "a= 0.132826607090464"
[1] "l= 376.430604494374"
[1] "New points:"
   X    Y 
1370 1359 
   X    Y 
 770 1559 
       X        Y 
1021.480 1767.122 
   X    Y 
1060 1799 
[1] "Storing new segment 2"
simplify.outline: Removing vertex 19
Triangulating...
[1] "Non-adjacent points in rim connected by line: 36 10"
[1] "In triangle: 20" "In triangle: 21"
[1] "Other points in triangles: 37 9"
[1] "Non-adjacent points in rim connected by line: 259 257"
[1] "In triangle: 460" "In triangle: 462"
[1] "Other points in triangles: 8 256"
[1] "Non-adjacent points in rim connected by line: 412 394"
[1] "In triangle: 707" "In triangle: 744"
[1] "Other points in triangles: 6 393"
Stitching...
Tear 1 child of rim
Tear 2 child of rim
Tear 3 child of rim
Tear 4 child of rim
Tear 1 : Sf = 1106.7520047418 ; Sb = 1104.76241789807
  Forwards path
    i = 130 ; sf/Sf = 0.5 ; sf = 553.376002370901
      k =    7 ; sb/Sb = 0 ; sb = 0
      k =  396 ; sb/Sb = 0.25 ; sb = 276.190604474519
      k =  326 ; sb/Sb = 0.5 ; sb = 552.381208949037
      k =  412 ; sb/Sb = 0.75 ; sb = 828.571813423556
      Creating new point: f = 0
      Point 326 already exists
    i = 257 ; sf/Sf = 0.75 ; sf = 830.064003556352
      k =    7 ; sb/Sb = 0 ; sb = 0
      k =  396 ; sb/Sb = 0.25 ; sb = 276.190604474519
      k =  326 ; sb/Sb = 0.5 ; sb = 552.381208949037
      k =  412 ; sb/Sb = 0.75 ; sb = 828.571813423556
      k =    6 ; sb/Sb = 1 ; sb = 1104.76241789807
      Creating new point: f = 0
      Point 412 already exists
Tear 2 : Sf = 1595.14088210748 ; Sb = 1503.00778904223
  Forwards path
    i = 14 ; sf/Sf = 0.230680182538691 ; sf = 367.967389859482
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   12 ; sb/Sb = 0.119018304165925 ; sb = 178.885438199983
      k =  124 ; sb/Sb = 0.339263728124444 ; sb = 509.916025910545
      Creating new point: f = 0.506988414859399
    i = 239 ; sf/Sf = 0.456713589111556 ; sf = 728.522517405881
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   12 ; sb/Sb = 0.119018304165925 ; sb = 178.885438199983
      k =  124 ; sb/Sb = 0.339263728124444 ; sb = 509.916025910545
      k =   52 ; sb/Sb = 0.559509152082963 ; sb = 840.946613621107
      Creating new point: f = 0.533268110075389
    i = 15 ; sf/Sf = 0.682746995684422 ; sf = 1089.07764495228
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   12 ; sb/Sb = 0.119018304165925 ; sb = 178.885438199983
      k =  124 ; sb/Sb = 0.339263728124444 ; sb = 509.916025910545
      k =   52 ; sb/Sb = 0.559509152082963 ; sb = 840.946613621107
      k =   46 ; sb/Sb = 0.779754576041481 ; sb = 1171.97720133167
      Creating new point: f = 0.55954780529138
Tear 3 : Sf = 1927.71298869418 ; Sb = 2025.49873893527
  Forwards path
    i = 386 ; sf/Sf = 0.28379908102097 ; sf = 547.083174663597
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =   21 ; sb/Sb = 0.243872559342494 ; sb = 493.963561409139
      k =  421 ; sb/Sb = 0.432904419506871 ; sb = 876.847355790672
      Creating new point: f = 0.211215832313967
    i = 23 ; sf/Sf = 0.567598162041941 ; sf = 1094.16634932719
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =   21 ; sb/Sb = 0.243872559342494 ; sb = 493.963561409139
      k =  421 ; sb/Sb = 0.432904419506871 ; sb = 876.847355790672
      k =  201 ; sb/Sb = 0.621936279671247 ; sb = 1259.7311501722
      Creating new point: f = 0.71254518903821
    i = 379 ; sf/Sf = 0.78379908102097 ; sf = 1510.93966901069
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =   21 ; sb/Sb = 0.243872559342494 ; sb = 493.963561409139
      k =  421 ; sb/Sb = 0.432904419506871 ; sb = 876.847355790672
      k =  201 ; sb/Sb = 0.621936279671247 ; sb = 1259.7311501722
      k =  429 ; sb/Sb = 0.810968139835624 ; sb = 1642.61494455374
      Creating new point: f = 0.856272594519105
Tear 4 : Sf = 3382.42733541947 ; Sb = 3337.06402438447
  Forwards path
    i = 1 ; sf/Sf = 0.096507795178959 ; sf = 326.430604494374
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      Creating new point: f = 0.0184200312986448
    i = 2 ; sf/Sf = 0.11129007874095 ; sf = 376.430604494374
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      Creating new point: f = 0.174413375255492
    i = 40 ; sf/Sf = 0.219554538597143 ; sf = 742.627272966385
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      Creating new point: f = 0.292816142435786
    i = 3 ; sf/Sf = 0.327818998453336 ; sf = 1108.8239414384
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      Creating new point: f = 0.348479994115033
    i = 62 ; sf/Sf = 0.44190385165033 ; sf = 1494.70766744922
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      k =  286 ; sb/Sb = 0.509548845251629 ; sb = 1700.39712015586
      Creating new point: f = 0.411335718750691
    i = 60 ; sf/Sf = 0.555988704847323 ; sf = 1880.59139346005
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      k =  286 ; sb/Sb = 0.509548845251629 ; sb = 1700.39712015586
      k =   28 ; sb/Sb = 0.624461531065925 ; sb = 2083.86810993214
      Creating new point: f = 0.40413170457736
    i = 255 ; sf/Sf = 0.670073558044317 ; sf = 2266.47511947088
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      k =  286 ; sb/Sb = 0.509548845251629 ; sb = 1700.39712015586
      k =   28 ; sb/Sb = 0.624461531065925 ; sb = 2083.86810993214
      k =  337 ; sb/Sb = 0.812230765532962 ; sb = 2710.4660671583
      Creating new point: f = 0.242915337583692
    i = 4 ; sf/Sf = 0.78415841124131 ; sf = 2652.35884548171
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      k =  286 ; sb/Sb = 0.509548845251629 ; sb = 1700.39712015586
      k =   28 ; sb/Sb = 0.624461531065925 ; sb = 2083.86810993214
      k =  337 ; sb/Sb = 0.812230765532962 ; sb = 2710.4660671583
      Creating new point: f = 0.85049545325499
    i = 349 ; sf/Sf = 0.892079205620655 ; sf = 3017.39309045059
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =  157 ; sb/Sb = 0.0947622711779308 ; sb = 316.227766016838
      k =   30 ; sb/Sb = 0.189524542355862 ; sb = 632.455532033676
      k =  267 ; sb/Sb = 0.292080350896598 ; sb = 974.690831206628
      k =   29 ; sb/Sb = 0.394636159437334 ; sb = 1316.92613037958
      k =  286 ; sb/Sb = 0.509548845251629 ; sb = 1700.39712015586
      k =   28 ; sb/Sb = 0.624461531065925 ; sb = 2083.86810993214
      k =  337 ; sb/Sb = 0.812230765532962 ; sb = 2710.4660671583
      k =  403 ; sb/Sb = 0.906115382766481 ; sb = 3023.76504577138
      Creating new point: f = 0.850495453254989
Tear 1 : Sf = 1104.76241789807 ; Sb = 1106.7520047418
  Backwards path
    i = 396 ; sf/Sf = 0.25 ; sf = 276.190604474519
      k =    7 ; sb/Sb = 0 ; sb = 0
      k =  130 ; sb/Sb = 0.5 ; sb = 553.376002370901
      Creating new point: f = 0.5
    i = 326 ; sf/Sf = 0.5 ; sf = 552.381208949037
      k =    7 ; sb/Sb = 0 ; sb = 0
      k =  130 ; sb/Sb = 0.5 ; sb = 553.376002370901
      k =  257 ; sb/Sb = 0.75 ; sb = 830.064003556352
      Creating new point: f = 0
      Point 130 already exists
    i = 412 ; sf/Sf = 0.75 ; sf = 828.571813423556
      k =    7 ; sb/Sb = 0 ; sb = 0
      k =  130 ; sb/Sb = 0.5 ; sb = 553.376002370901
      k =  257 ; sb/Sb = 0.75 ; sb = 830.064003556352
      k =    8 ; sb/Sb = 1 ; sb = 1106.7520047418
      Creating new point: f = 0
      Point 257 already exists
Tear 2 : Sf = 1503.00778904223 ; Sb = 1595.14088210748
  Backwards path
    i = 12 ; sf/Sf = 0.119018304165925 ; sf = 178.885438199983
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   14 ; sb/Sb = 0.230680182538691 ; sb = 367.967389859482
      Creating new point: f = 0.515945075368418
    i = 124 ; sf/Sf = 0.339263728124444 ; sf = 509.916025910545
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   14 ; sb/Sb = 0.230680182538691 ; sb = 367.967389859482
      k =  239 ; sb/Sb = 0.456713589111556 ; sb = 728.522517405881
      Creating new point: f = 0.480387157067199
    i = 52 ; sf/Sf = 0.559509152082963 ; sf = 840.946613621107
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   14 ; sb/Sb = 0.230680182538691 ; sb = 367.967389859482
      k =  239 ; sb/Sb = 0.456713589111556 ; sb = 728.522517405881
      k =   15 ; sb/Sb = 0.682746995684422 ; sb = 1089.07764495228
      Creating new point: f = 0.454780399632073
    i = 46 ; sf/Sf = 0.779754576041481 ; sf = 1171.97720133167
      k =   13 ; sb/Sb = 0 ; sb = 0
      k =   14 ; sb/Sb = 0.230680182538691 ; sb = 367.967389859482
      k =  239 ; sb/Sb = 0.456713589111556 ; sb = 728.522517405881
      k =   15 ; sb/Sb = 0.682746995684422 ; sb = 1089.07764495228
      k =   16 ; sb/Sb = 1 ; sb = 1595.14088210748
      Creating new point: f = 0.305773559390991
Tear 3 : Sf = 2025.49873893527 ; Sb = 1927.71298869418
  Backwards path
    i = 21 ; sf/Sf = 0.243872559342494 ; sf = 493.963561409139
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =  386 ; sb/Sb = 0.28379908102097 ; sb = 547.083174663597
      Creating new point: f = 0.859314126265525
    i = 421 ; sf/Sf = 0.432904419506871 ; sf = 876.847355790672
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =  386 ; sb/Sb = 0.28379908102097 ; sb = 547.083174663597
      k =   23 ; sb/Sb = 0.567598162041941 ; sb = 1094.16634932719
      Creating new point: f = 0.525390490869428
    i = 201 ; sf/Sf = 0.621936279671247 ; sf = 1259.7311501722
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =  386 ; sb/Sb = 0.28379908102097 ; sb = 547.083174663597
      k =   23 ; sb/Sb = 0.567598162041941 ; sb = 1094.16634932719
      k =  379 ; sb/Sb = 0.78379908102097 ; sb = 1510.93966901069
      Creating new point: f = 0.251331575674648
    i = 429 ; sf/Sf = 0.810968139835624 ; sf = 1642.61494455374
      k =   22 ; sb/Sb = 0 ; sb = 0
      k =  386 ; sb/Sb = 0.28379908102097 ; sb = 547.083174663597
      k =   23 ; sb/Sb = 0.567598162041941 ; sb = 1094.16634932719
      k =  379 ; sb/Sb = 0.78379908102097 ; sb = 1510.93966901069
      k =   24 ; sb/Sb = 1 ; sb = 1927.71298869418
      Creating new point: f = 0.125665787837324
Tear 4 : Sf = 3337.06402438447 ; Sb = 3382.42733541947
  Backwards path
    i = 157 ; sf/Sf = 0.0947622711779308 ; sf = 316.227766016838
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      Creating new point: f = 0.98191312942347
    i = 30 ; sf/Sf = 0.189524542355862 ; sf = 632.455532033676
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      Creating new point: f = 0.722623691272556
    i = 267 ; sf/Sf = 0.292080350896598 ; sf = 974.690831206628
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      Creating new point: f = 0.669894925775184
    i = 29 ; sf/Sf = 0.394636159437334 ; sf = 1316.92613037958
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      k =   62 ; sb/Sb = 0.44190385165033 ; sb = 1494.70766744922
      Creating new point: f = 0.585679510571162
    i = 286 ; sf/Sf = 0.50954884525163 ; sf = 1700.39712015586
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      k =   62 ; sb/Sb = 0.44190385165033 ; sb = 1494.70766744922
      k =   60 ; sb/Sb = 0.555988704847323 ; sb = 1880.59139346005
      Creating new point: f = 0.592935799150263
    i = 28 ; sf/Sf = 0.624461531065925 ; sf = 2083.86810993214
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      k =   62 ; sb/Sb = 0.44190385165033 ; sb = 1494.70766744922
      k =   60 ; sb/Sb = 0.555988704847323 ; sb = 1880.59139346005
      k =  255 ; sb/Sb = 0.670073558044317 ; sb = 2266.47511947088
      Creating new point: f = 0.600192087729366
    i = 337 ; sf/Sf = 0.812230765532963 ; sf = 2710.4660671583
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      k =   62 ; sb/Sb = 0.44190385165033 ; sb = 1494.70766744922
      k =   60 ; sb/Sb = 0.555988704847323 ; sb = 1880.59139346005
      k =  255 ; sb/Sb = 0.670073558044317 ; sb = 2266.47511947088
      k =    4 ; sb/Sb = 0.78415841124131 ; sb = 2652.35884548171
      k =  349 ; sb/Sb = 0.892079205620655 ; sb = 3017.39309045059
      Creating new point: f = 0.260119974589669
    i = 403 ; sf/Sf = 0.906115382766481 ; sf = 3023.76504577138
      k =   31 ; sb/Sb = 0 ; sb = 0
      k =    1 ; sb/Sb = 0.096507795178959 ; sb = 326.430604494374
      k =    2 ; sb/Sb = 0.11129007874095 ; sb = 376.430604494374
      k =   40 ; sb/Sb = 0.219554538597143 ; sb = 742.627272966385
      k =    3 ; sb/Sb = 0.327818998453336 ; sb = 1108.8239414384
      k =   62 ; sb/Sb = 0.44190385165033 ; sb = 1494.70766744922
      k =   60 ; sb/Sb = 0.555988704847323 ; sb = 1880.59139346005
      k =  255 ; sb/Sb = 0.670073558044317 ; sb = 2266.47511947088
      k =    4 ; sb/Sb = 0.78415841124131 ; sb = 2652.35884548171
      k =  349 ; sb/Sb = 0.892079205620655 ; sb = 3017.39309045059
      k =    5 ; sb/Sb = 1 ; sb = 3382.42733541947
      Creating new point: f = 0.130059987294835
Triangulating...
[1] "Non-adjacent points in rim connected by line: 36 10"
[1] "In triangle: 281" "In triangle: 286"
[1] "Other points in triangles: 9 433"
Merging points...
Projecting to sphere...
Optimising mapping with FIRE...
E =  0.00190 | E_L =  0.00190 | E_A =  0.00000 |   0 flippped triangles
E =  0.00166 | E_L =  0.00166 | E_A =  0.00000 |   9 flippped triangles
       phi0    phi0.1    phi0.2    phi0.3    phi0.4    phi0.5    phi0.6
id    245.0 281.00000  452.0000  675.0000  681.0000 689.00000   696.000
A   49968.9 402.74766 1043.1882  313.0939  321.6641  46.95193  1036.443
a  -12884.2 -30.69371 -987.4843 -414.8502 -442.4883 -48.81100 -1021.074
      phi0.7    phi0.8
id   759.000  863.0000
A   1064.813  117.2293
a  -1100.088 -114.2440
E =  0.00166 | E_L =  0.00166 | E_A =  0.00000 |  10 flippped triangles
        phi0   phi0.1    phi0.2    phi0.3    phi0.4    phi0.5    phi0.6
id    242.00    245.0 281.00000  452.0000  675.0000  681.0000 689.00000
A   37218.42  49968.9 402.74766 1043.1882  313.0939  321.6641  46.95193
a  -29290.32 -40020.2 -35.94368 -838.4811 -414.7182 -434.3179 -43.70559
      phi0.7    phi0.8    phi0.9
id  696.0000   759.000  863.0000
A  1036.4431  1064.813  117.2293
a  -958.9583 -1074.387 -114.0085
FIRE:  3  stops.  0 hits of maxmove.  0 hits of dtmax.
Frms = 1.90392794792543e-06; Ftanrms = 1.90331695739533e-06
E =  0.00280 | E_L =  0.00280 | E_A =  0.00000 |   0 flippped triangles
E =  0.00173 | E_L =  0.00173 | E_A =  0.00000 |   0 flippped triangles
E =  0.00170 | E_L =  0.00170 | E_A =  0.00000 |   0 flippped triangles
E =  0.00168 | E_L =  0.00168 | E_A =  0.00000 |   0 flippped triangles
E =  0.00168 | E_L =  0.00168 | E_A =  0.00000 |   0 flippped triangles
Optimising mapping with BFGS...
E =  0.00168 | E_L =  0.00168 | E_A =  0.00000 |   0 flippped triangles
Transforming image...
Mapping optimised. Error: 0.001681507 ; 0 flipped triangles.
Inferring coordinates of datapoints
Inferring coordinates of landmarks
Mapping optimised. Error: 0.001681507 ; 0 flipped triangles. OD displacement: 4.193878 degrees.
Computing Kernel Density estimates of datapoints

[1] 0.7
Saving adult_retina/data/C57BL6J/GM522/R-CONTRA/r.mat
